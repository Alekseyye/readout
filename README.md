# Нейросеть для определения показаний аналоговых счётчиков
Исходный код модели нейросети взят из репозитория jomjol на Github: https://github.com/jomjol/neural-network-digital-counter-readout
В код внесены некоторые правки для того, чтобы он работал с новыми версиями используемых библиотек

Задача нейросети заключается в определении цифр на изображениях и сопоставлении им соответствующих значений. В случае, если цифру невозможно определить (например, когда барабан счётчика находится между двумя цифрами), нейросеть должна отсеивать изображение (присваивая ему значение NaN).

Счётчик выглядит следующим образом:

<img src="./images/counter_complete.png" width="250">  

Нейросеть ставит в соответствие каждому из полученных изображений одно из 11 значений: 10 цифр - от 0 до 9, или NaN

| Picture        | Value           | Picture        | Value           | Picture        | Value           | Picture        | Value           |
| ------------- |:-------------:| ------------- |:-------------:|------------- |:-------------:| ------------- |:-------------:|
| <img src="./images/counter2.jpg" width="60"> | 2 | <img src="./images/counter6.jpg" width="60"> | 6 |<img src="./images/counter9.jpg" width="60"> | 9 | <img src="./images/counterNaN.jpg" width="60"> | NaN |

Изображения нейросеть должна получать с изображения с камеры, наблюдающей за счётчиком. Из этого изображения "вырезаются" фрагменты, содержащие цифры, и далее обрабатываются нейросетью.

В папке приложен датасет с примерами (примерно по 150 для каждой из цифр, около 3700 для значения NaN). С помощью кода ImagePreparation они переведены в RGB-изображения с разрешением 32х20, код ImageAugmentation предназначен для создания "искажённых" изображений, которым нейросеть должна определять значение NaN. С использованием этого датасета нейросеть будет обучаться.

Тренировка нейросети производится в ходе выполнения кода Train_CNN_Digital_Readout, реализованного с использованием библиотек TensorFlow и Keras (открытые библиотеки для машинного обучения и взаимодействия с нейросетями). Сначала нейросеть обучается определению цифр, используя данные из датасета с изменёнными в некоторых пределах углами наклона цифр, яркостью изображения и положением цифр на изображении. На выходе получаем рабочую модель нейросети в формате .h5, который можно использовать далее в качестве вводного данного в других проектах (например, для считывания данных с счётчика воды или электричества).
